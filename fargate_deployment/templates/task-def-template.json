{
  "family": "REPLACE_TASK_FAMILY",
  "networkMode": "awsvpc",
  "requiresCompatibilities": ["FARGATE"],
  "cpu": "512",
  "memory": "1024",
  "executionRoleArn": "REPLACE_EXEC_ROLE",
  "taskRoleArn": "REPLACE_TASK_ROLE",
  "ephemeralStorage": { "sizeInGiB": 30 },
  "runtimePlatform": {
    "operatingSystemFamily": "LINUX",
    "cpuArchitecture": "X86_64"
  },
  "containerDefinitions": [
    {
      "name": "patient-pipeline",
      "image": "REPLACE_IMAGE_URI",
      "essential": true,
      "readonlyRootFilesystem": false,
      "stopTimeout": 60,
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-group": "REPLACE_LOG_GROUP",
          "awslogs-region": "REPLACE_AWS_REGION",
          "awslogs-stream-prefix": "REPLACE_LOG_STREAM_PREFIX"
        }
      },

      "secrets": [],

      "environment": [
        { "name": "AWS_REGION", "value": "REPLACE_AWS_REGION" },

        { "name": "INPUT_S3", "value": "REPLACE_INPUT_S3" },
        { "name": "OUTPUT_S3", "value": "REPLACE_OUTPUT_S3" },
        { "name": "AUDIT_BUCKET", "value": "REPLACE_AUDIT_BUCKET" },
        { "name": "AUDIT_PREFIX", "value": "REPLACE_AUDIT_PREFIX" },

        { "name": "EMAIL_FROM", "value": "REPLACE_EMAIL_FROM" },
        { "name": "EMAIL_TO", "value": "REPLACE_EMAIL_TO" },
        { "name": "EMAIL_SUBJECT", "value": "REPLACE_EMAIL_SUBJECT" },

        { "name": "PHYSICIAN_ID_LIST", "value": "REPLACE_PHYSICIAN_ID_LIST" },
        { "name": "THRESHOLD", "value": "REPLACE_THRESHOLD" },
        { "name": "START_DATE", "value": "REPLACE_START_DATE" },
        { "name": "END_DATE", "value": "REPLACE_END_DATE" },

        { "name": "OPENAI_MODEL", "value": "REPLACE_OPENAI_MODEL" },
        { "name": "OPENAI_THROTTLE_SEC", "value": "REPLACE_OPENAI_THROTTLE_SEC" },

        { "name": "RUN_ID", "value": "REPLACE_RUN_ID" },
        { "name": "LLM_DISABLED", "value": "REPLACE_LLM_DISABLED" },
        { "name": "DRY_RUN_EMAIL", "value": "REPLACE_DRY_RUN_EMAIL" },
        { "name": "MAX_NOTES", "value": "REPLACE_MAX_NOTES" },

        { "name": "LOG_FORMAT", "value": "REPLACE_LOG_FORMAT" },
        { "name": "LOG_LEVEL", "value": "REPLACE_LOG_LEVEL" },

        { "name": "RAG_ENABLED", "value": "REPLACE_RAG_ENABLED" },
        { "name": "RAG_KB_PATH", "value": "REPLACE_RAG_KB_PATH" },
        { "name": "RAG_TOP_K", "value": "REPLACE_RAG_TOP_K" },
        { "name": "RAG_MAX_CHARS", "value": "REPLACE_RAG_MAX_CHARS" },
        { "name": "RAG_AUDIT_MAX_CHARS", "value": "REPLACE_RAG_AUDIT_MAX_CHARS" },

        { "name": "USE_LANGCHAIN", "value": "REPLACE_USE_LANGCHAIN" },
        { "name": "OPENAI_TEMPERATURE", "value": "REPLACE_OPENAI_TEMPERATURE" },
        { "name": "OPENAI_MAX_TOKENS", "value": "REPLACE_OPENAI_MAX_TOKENS" },
        { "name": "OPENAI_TIMEOUT_SEC", "value": "REPLACE_OPENAI_TIMEOUT_SEC" }
      ],

      "command": ["python", "-m", "src.patient_risk_pipeline"]
    }
  ]
}
